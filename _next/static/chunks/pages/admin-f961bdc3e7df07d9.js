(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[964],{577:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin",function(){return n(9124)}])},4616:function(e,t,n){"use strict";var a=n(5893);let s=e=>{let{suit:t,rank:n}=e,s="flex-1 text-center text-5xl mt-3 ".concat("red-600"==("hearts"===t||"diamonds"===t?"red-600":"black")?"text-red-600":"text-black"," text-opacity-100");return(0,a.jsxs)("div",{className:"flex box-boarder bg-white h-20 w-1/4 p-1 mx-1 px-3 boarder-1 shadow-md",children:[(0,a.jsx)("p",{className:s,children:function(e){switch(e){case"spades":return"♠";case"hearts":return"♥";case"diamonds":return"♦";case"clubs":return"♣"}}(t)}),(0,a.jsx)("p",{className:s,children:function(e){switch(e){case"ace":return"A";case"jack":return"J";case"queen":return"Q";case"king":return"K";default:return e}}(n)})]})};t.Z=s},7273:function(e,t,n){"use strict";var a=n(5893),s=n(7294);t.Z=function(e){let{isOpen:t,onClose:n,onSubmit:r}=e,[l,c]=(0,s.useState)(""),i=()=>{r(l),n()};return t?(0,a.jsx)("div",{className:"fixed inset-0 form-control items-center justify-center z-50 rounded",children:(0,a.jsxs)("div",{className:"bg-primary p-4 rounded",children:[(0,a.jsx)("label",{className:"label",children:(0,a.jsx)("span",{className:"label-text text-xl text-primary-content",children:"Endpoint (e.g. wss://192.0.2.1 )"})}),(0,a.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),className:"input input-bordered p-3"}),(0,a.jsx)("button",{onClick:i,className:"btn btn-primary ml-2",children:"Set"})]})}):null}},9124:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var a=n(5893),s=n(7294),r=function(e){let{isOpen:t,onClose:n,onConfirm:s,title:r,message:l,confirmText:c}=e;return t?(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-base-100 p-6 rounded-lg max-w-md w-full",children:[(0,a.jsx)("h3",{className:"font-bold text-lg",children:r}),(0,a.jsx)("p",{className:"py-4",children:l}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)("button",{className:"btn",onClick:n,children:"Cancel"}),(0,a.jsx)("button",{className:"btn btn-error",onClick:s,children:c})]})]})}):null},l=n(7273),c=n(4616),i=n(9616);let o=["player","muck","board","unknown"];function d(){let[e,t]=(0,s.useState)(!0),[n,d]=(0,s.useState)(!1),[u,m]=(0,s.useState)({open:!1,antennaId:null}),[h,p]=(0,s.useState)(""),[x,f]=(0,s.useState)([]),[b,y]=(0,s.useState)([]),[j,w]=(0,s.useState)(null),[N,g]=(0,s.useState)({}),[v,k]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("hostname");e&&E(e)},[]),(0,s.useEffect)(()=>{v&&x.length>0&&x.forEach(e=>{T(e.id)})},[v,x]);let E=e=>{let n=S(e);p(e),localStorage.setItem("hostname",e);let a=new i.s(n);k(a),t(!1),_(a)},_=async e=>{try{let[t,n]=await Promise.all([e.getPlayers(),e.getAntennas()]);f(t.players),y(n.antenna),w(null)}catch(e){console.error("Failed to fetch data:",e),w(e instanceof Error?e.message:"Failed to fetch data")}},T=async e=>{if(v)try{let t=await v.getPlayerHand(e);g(n=>({...n,[e]:{cards:t.hand.cards,is_muck:t.hand.is_muck}}))}catch(t){if(t instanceof Error&&"Not found"===t.message){g(t=>({...t,[e]:{cards:[],is_muck:!1,error:"Hand not found (404)"}}));return}console.error("Failed to fetch hand for player ".concat(e,":"),t)}},S=e=>e.startsWith("wss://")?e.replace("wss://","https://"):e.startsWith("ws://")?e.replace("ws://","http://"):e,C=async(e,t)=>{if(v)try{await v.updatePlayer(e.id,t);let{players:n}=await v.getPlayers();f(n),w(null)}catch(e){console.error("Failed to update player name:",e),w(e instanceof Error?e.message:"Failed to update player name")}},P=async(e,t)=>{if(v)try{await v.updateAntennaType(e.id,t);let{antenna:n}=await v.getAntennas();y(n),w(null)}catch(e){console.error("Failed to update antenna type:",e),w(e instanceof Error?e.message:"Failed to update antenna type")}},F=async e=>{if(v)try{await v.deleteAntenna(e);let{antenna:t}=await v.getAntennas();y(t),w(null),m({open:!1,antennaId:null})}catch(e){console.error("Failed to delete antenna:",e),w(e instanceof Error?e.message:"Failed to delete antenna"),m({open:!1,antennaId:null})}},U=async e=>{if(v)try{await v.muckHand(e),await T(e),w(null)}catch(e){console.error("Failed to muck hand:",e),w(e instanceof Error?e.message:"Failed to muck hand")}},I=async()=>{if(v)try{await v.resetGame();let{players:e}=await v.getPlayers();f(e),w(null),d(!1)}catch(e){console.error("Failed to reset game:",e),w(e instanceof Error?e.message:"Failed to reset game"),d(!1)}};return(0,a.jsxs)("main",{className:"flex w-full min-h-screen flex-col items-center justify-between p-2",children:[(0,a.jsx)(l.Z,{isOpen:e,onClose:()=>t(!1),onSubmit:E}),(0,a.jsx)(r,{isOpen:n,onClose:()=>d(!1),onConfirm:I,title:"ゲームをリセットしますか？",message:"この操作は取り消せません。本当に実行してよろしいですか？",confirmText:"リセット"}),(0,a.jsx)(r,{isOpen:u.open,onClose:()=>m({open:!1,antennaId:null}),onConfirm:()=>u.antennaId&&F(u.antennaId),title:"アンテナを削除しますか？",message:"この操作は取り消せません。本当に実行してよろしいですか？",confirmText:"削除"}),(0,a.jsxs)("div",{className:"flex-1 z-10 w-full max-w-5xl items-center justify-between font-mono text-sm bg-base-100",children:[(0,a.jsxs)("div",{className:"navbar navbar-center bg-base-100 w-full",children:[(0,a.jsx)("a",{className:"btn btn-ghost navbar-start normal-case text-xl text-accent-content",children:"Admin - RFID Poker"}),(0,a.jsx)("div",{className:"navbar-end",children:(0,a.jsx)("button",{onClick:function(){localStorage.removeItem("hostname"),p(""),k(null),t(!0)},className:"btn btn-primary normal-case",children:"Remove Endpoint"})})]}),(0,a.jsxs)("h1",{className:"text-2xl font-bold mb-4",children:["Hostname: ",h]}),j&&(0,a.jsx)("div",{className:"alert alert-error shadow-lg mb-4",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("span",{children:j})]})}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Antennas"}),(0,a.jsx)("div",{className:"space-y-4 mb-8",children:null==b?void 0:b.map(e=>(0,a.jsxs)("form",{className:"flex items-center gap-4",onSubmit:t=>{t.preventDefault();let n=new FormData(t.currentTarget),a=n.get("antennaType");P(e,a)},children:[(0,a.jsxs)("span",{className:"w-24",children:["ID ",e.id,":"]}),(0,a.jsxs)("span",{className:"w-48",children:[e.device_id," / ",e.pair_id]}),(0,a.jsx)("select",{name:"antennaType",defaultValue:e.antenna_type_name,className:"select select-bordered w-48",children:o.map(e=>(0,a.jsx)("option",{value:e,children:e},e))}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update Type"}),(0,a.jsx)("button",{type:"button",onClick:()=>m({open:!0,antennaId:e.id}),className:"btn btn-error",children:"Delete"})]},e.id))}),(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Players"}),(0,a.jsx)("div",{className:"space-y-4",children:null==x?void 0:x.map((e,t)=>{var n,s,r,l,i,o,d;return(0,a.jsxs)("div",{children:[(0,a.jsxs)("form",{className:"flex items-center gap-4",onSubmit:t=>{t.preventDefault();let n=new FormData(t.currentTarget),a=n.get("playerName");C(e,a)},children:[(0,a.jsxs)("span",{className:"w-24",children:["Player ",t+1,":"]}),(0,a.jsxs)("span",{className:"w-48",children:[e.device_id," / ",e.pair_id]}),(0,a.jsx)("input",{type:"text",name:"playerName",defaultValue:e.name,className:"input input-bordered w-full max-w-xs",placeholder:"Enter Player ".concat(t+1," name")}),(0,a.jsx)("button",{type:"submit",className:"btn btn-primary",children:"Update"})]}),(0,a.jsxs)("div",{className:"flex mt-2 ml-24 items-center",children:[(null===(n=N[e.id])||void 0===n?void 0:n.error)?(0,a.jsx)("span",{className:"text-xl",children:N[e.id].error}):(null===(s=N[e.id])||void 0===s?void 0:s.is_muck)?(0,a.jsx)("span",{className:"text-xl",children:"Mucked"}):null===(r=N[e.id])||void 0===r?void 0:null===(l=r.cards)||void 0===l?void 0:l.map((e,t)=>(0,a.jsx)(c.Z,{suit:e.suit,rank:e.rank},t)),(null===(i=N[e.id])||void 0===i?void 0:null===(o=i.cards)||void 0===o?void 0:o.length)>0&&!(null===(d=N[e.id])||void 0===d?void 0:d.is_muck)&&(0,a.jsx)("button",{onClick:()=>U(e.id),className:"btn btn-error ml-4",children:"Muck Hand"})]})]},e.id)})}),(0,a.jsxs)("div",{className:"mt-8 border-t pt-4",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Operations"}),(0,a.jsx)("div",{className:"flex gap-4",children:(0,a.jsx)("button",{onClick:()=>d(!0),className:"btn btn-error",children:"Reset Game"})})]})]})]})]})}},9616:function(e,t,n){"use strict";n.d(t,{s:function(){return a}});class a{static convertToHttpUrl(e){return e.startsWith("wss://")?e.replace("wss://","https://"):e.startsWith("ws://")?e.replace("ws://","http://"):e}async handleResponse(e){if(204===e.status)return{};if(404===e.status)throw Error("Not found");if(!e.ok){let t=await e.json();throw Error(t.error||"HTTP error! status: ".concat(e.status))}return e.json()}async getPlayers(){let e=await fetch("".concat(this.httpUrl,"/admin/player"));return this.handleResponse(e)}async getAntennas(){let e=await fetch("".concat(this.httpUrl,"/admin/antenna"));return this.handleResponse(e)}async getPlayerHand(e){let t=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e,"/hand"));return this.handleResponse(t)}async updatePlayer(e,t){let n=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})});return this.handleResponse(n)}async updateAntennaType(e,t){let n=await fetch("".concat(this.httpUrl,"/admin/antenna/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({antenna_type_name:t})});return this.handleResponse(n)}async deleteAntenna(e){let t=await fetch("".concat(this.httpUrl,"/admin/antenna/").concat(e),{method:"DELETE"});return this.handleResponse(t)}async muckHand(e){let t=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e,"/hand"),{method:"DELETE"});return this.handleResponse(t)}async resetGame(){let e=await fetch("".concat(this.httpUrl,"/admin/game"),{method:"DELETE"});return this.handleResponse(e)}constructor(e){this.httpUrl=a.convertToHttpUrl(e)}}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=577)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[823],{1425:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user-status",function(){return a(9555)}])},7273:function(e,t,a){"use strict";var n=a(5893),s=a(7294);t.Z=function(e){let{isOpen:t,onClose:a,onSubmit:r}=e,[l,c]=(0,s.useState)(""),i=()=>{r(l),a()};return t?(0,n.jsx)("div",{className:"fixed inset-0 form-control items-center justify-center z-50 rounded",children:(0,n.jsxs)("div",{className:"bg-primary p-4 rounded",children:[(0,n.jsx)("label",{className:"label",children:(0,n.jsx)("span",{className:"label-text text-xl text-primary-content",children:"Endpoint (e.g. wss://192.0.2.1 )"})}),(0,n.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),className:"input input-bordered p-3"}),(0,n.jsx)("button",{onClick:i,className:"btn btn-primary ml-2",children:"Set"})]})}):null}},9555:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return c}});var n=a(5893),s=a(7294),r=a(9616),l=a(7273);function c(){let[e,t]=(0,s.useState)(!0),[a,c]=(0,s.useState)(""),[o,d]=(0,s.useState)([]),[h,u]=(0,s.useState)({}),[m,f]=(0,s.useState)(null),[p,x]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=localStorage.getItem("hostname");e&&b(e)},[]),(0,s.useEffect)(()=>{p&&o.length>0&&o.forEach(e=>{y(e.id)})},[p,o]),(0,s.useEffect)(()=>{if(p){let e=setInterval(()=>{w()},2e3);return()=>clearInterval(e)}},[p]);let b=e=>{c(e),localStorage.setItem("hostname",e);let a=new r.s(e);x(a),t(!1),w()},w=async()=>{if(p)try{let e=await p.getPlayers();d(e.players),e.players.forEach(e=>{y(e.id)}),f(null)}catch(e){console.error("Failed to fetch data:",e),f(e instanceof Error?e.message:"Failed to fetch data")}},y=async e=>{if(p)try{let t=await p.getPlayerHand(e);t.hand.is_muck?u(t=>({...t,[e]:"Mucked"})):t.hand.cards&&t.hand.cards.length>0&&u(t=>({...t,[e]:"Readed"}))}catch(t){if(t instanceof Error&&"Not found"===t.message){u(t=>({...t,[e]:"No Read"}));return}console.error("Failed to check status for player ".concat(e,":"),t)}};return(0,n.jsxs)("main",{className:"flex w-full min-h-screen flex-col items-center justify-between p-2",children:[(0,n.jsx)(l.Z,{isOpen:e,onClose:()=>t(!1),onSubmit:b}),(0,n.jsxs)("div",{className:"flex-1 z-10 w-full max-w-5xl items-center justify-between font-mono text-sm bg-base-100",children:[(0,n.jsxs)("div",{className:"navbar navbar-center bg-base-100 w-full",children:[(0,n.jsx)("a",{className:"btn btn-ghost navbar-start normal-case text-xl text-accent-content",children:"User Status - RFID Poker"}),(0,n.jsx)("div",{className:"navbar-end",children:(0,n.jsx)("button",{onClick:function(){localStorage.removeItem("hostname"),c(""),x(null),t(!0)},className:"btn btn-primary normal-case",children:"Remove Endpoint"})})]}),(0,n.jsxs)("h1",{className:"text-2xl font-bold mb-4",children:["Hostname: ",a]}),m&&(0,n.jsx)("div",{className:"alert alert-error shadow-lg mb-4",children:(0,n.jsxs)("div",{children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"stroke-current flex-shrink-0 h-6 w-6",fill:"none",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,n.jsx)("span",{children:m})]})}),(0,n.jsxs)("div",{className:"p-4",children:[(0,n.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Players Status"}),(0,n.jsx)("div",{className:"grid grid-cols-1 gap-4",children:o.map(e=>(0,n.jsx)("div",{className:"card bg-base-200 shadow-xl",children:(0,n.jsxs)("div",{className:"card-body flex flex-row items-center justify-between",children:[(0,n.jsx)("h2",{className:"card-title text-3xl",children:e.name}),(0,n.jsx)(i,{status:h[e.id]||"No Read"})]})},e.id))})]})]})]})}function i(e){let{status:t}=e,a="";switch(t){case"No Read":a="badge-error";break;case"Mucked":a="badge-warning";break;case"Readed":a="badge-success"}return(0,n.jsx)("div",{className:"badge ".concat(a," p-4 text-xl"),children:t})}},9616:function(e,t,a){"use strict";a.d(t,{s:function(){return n}});class n{static convertToHttpUrl(e){return e.startsWith("wss://")?e.replace("wss://","https://"):e.startsWith("ws://")?e.replace("ws://","http://"):e}async handleResponse(e){if(204===e.status)return{};if(404===e.status)throw Error("Not found");if(!e.ok){let t=await e.json();throw Error(t.error||"HTTP error! status: ".concat(e.status))}return e.json()}async getPlayers(){let e=await fetch("".concat(this.httpUrl,"/admin/player"));return this.handleResponse(e)}async getAntennas(){let e=await fetch("".concat(this.httpUrl,"/admin/antenna"));return this.handleResponse(e)}async getPlayerHand(e){let t=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e,"/hand"));return this.handleResponse(t)}async updatePlayer(e,t){let a=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t})});return this.handleResponse(a)}async updateAntennaType(e,t){let a=await fetch("".concat(this.httpUrl,"/admin/antenna/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({antenna_type_name:t})});return this.handleResponse(a)}async deleteAntenna(e){let t=await fetch("".concat(this.httpUrl,"/admin/antenna/").concat(e),{method:"DELETE"});return this.handleResponse(t)}async muckHand(e){let t=await fetch("".concat(this.httpUrl,"/admin/player/").concat(e,"/hand"),{method:"DELETE"});return this.handleResponse(t)}async resetGame(){let e=await fetch("".concat(this.httpUrl,"/admin/game"),{method:"DELETE"});return this.handleResponse(e)}constructor(e){this.httpUrl=n.convertToHttpUrl(e)}}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=1425)}),_N_E=e.O()}]);